[10:12:33] ✓ Validación OK. Arrancando modo single...
[10:12:33] Procesando: 767 - SICORE - RETENCIONES Y PERCEPC
[10:12:33] Modo de operación: ambas
[10:12:33] Iniciando navegador...
[10:12:33] Usando profile temporal: C:\Users\vicen\AppData\Local\Temp\studioai_mr_6c0238ce
[10:12:36] Navegando al login AFIP...
[10:12:40] Ingresando CUIT...
[10:12:40] Click en Siguiente...
[10:12:41] Ingresando clave...
[10:12:46] Login OK.
[10:12:46] Buscando servicio MIS RETENCIONES...
[10:12:54] Abriendo MIS RETENCIONES...
[10:12:59] Buscando dropdown de representados...
[10:12:59] Abriendo menú de usuario...
[10:13:01] Seleccionando CUIT objetivo: 30707656707...
[10:13:01] Seleccionando CUIT: 30-70765670-7...
[10:13:03] ✓ CUIT seleccionado
[10:13:03] 
[10:13:03] ============================================================
[10:13:03] PROCESANDO: 767 - SICORE - RETENCIONES Y PERCEPC - Retención y percepción
[10:13:03] ============================================================
[10:13:03] Llenando formulario de consulta...
[10:13:03] Seleccionando impuesto: IMP_767...
[10:13:04] ✓ Impuesto seleccionado
[10:13:04] Seleccionando tipo de operación: 0...
[10:13:04] ✓ Tipo de operación seleccionado
[10:13:04] Completando fechas: 01/01/2024 - 31/12/2024...
[10:13:04]   [DEBUG] Localizando campo 'Fecha desde'...
[10:13:04]   [DEBUG] Click en 'Fecha desde'...
[10:13:05]   [DEBUG] Llenando 'Fecha desde' con: 01/01/2024
[10:13:06]   [DEBUG] Presionando Tab para cerrar datepicker...
[10:13:06]   [DEBUG] Localizando campo 'Fecha hasta'...
[10:13:06]   [DEBUG] Click en 'Fecha hasta'...
[10:13:07]   [DEBUG] Llenando 'Fecha hasta' con: 31/12/2024
[10:13:07]   [DEBUG] Presionando Escape para cerrar datepicker...
[10:13:08] ✓ Formulario completado
[10:13:08] Haciendo click en Consultar...
[10:13:08] Esperando resultados...
[10:13:11] ✓ Resultados cargados
[10:13:11] Exportando a CSV...
[10:13:11]   [DEBUG] Buscando botón 'Exportar'...
[10:13:11]   [DEBUG] Click en botón 'Exportar'...
[10:13:13]   [DEBUG] Esperando menú dropdown...
[10:13:13]   [DEBUG] Menú dropdown visible
[10:13:13]   [DEBUG] Click en opción '.CSV'...
[10:13:15] ✓ Click en CSV completado - exportación iniciada
[10:13:15] [DEBUG] Verificando si aparece popup de exportación...
[10:13:18]   [DEBUG] Popup NO apareció (comportamiento nuevo esperado)
[10:13:18] Navegando manualmente a tab 'Consultas exportadas'...
[10:13:20]   [DEBUG] Buscando tab 'Consultas exportadas'...
[10:13:20]   [DEBUG] Probando selector #1: button#tabConsultasExportdas-tab
[10:13:20]   [DEBUG] Probando selector #2: button[aria-controls='tabConsultasExportdas']
[10:13:20]   [DEBUG] Probando selector #3: button:has-text('Consultas exportadas')
[10:13:20]   [DEBUG] Probando selector #4: a:has-text('Consultas exportadas')
[10:13:20]   [DEBUG] Probando selector #5: [role='tab']:has-text('Consultas exportadas')
[10:13:20] ⚠ No se pudo encontrar tab 'Consultas exportadas' - continuando de todas formas...
[10:13:22] Esperando a que el archivo esté listo...
[10:13:22] Intento 1/60: Buscando archivo...
[10:13:27] ⚠ Botón refresh no encontrado
[10:13:27]   [DEBUG] Buscando filas en tabla con selector '.ag-row[role='row']'
[10:13:27]   [DEBUG] Encontradas 30 filas en la tabla
[10:13:27]   [DEBUG] Analizando primera fila...
[10:13:27]   [DEBUG] Buscando celda 'filtros' con selector [col-id='filtros']
[10:13:32]   [DEBUG] Error leyendo filtros: Locator.wait_for: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("[col-id='filtros']")

[10:13:32]   [DEBUG] Intentando selector alternativo para filtros...
[10:13:37]   [DEBUG] Error con selector alternativo: Locator.text_content: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("div.ag-cell[col-id='filtros']")

[10:13:37]   [DEBUG] Buscando celda 'estado' con selector [col-id='estado']
[10:13:42]   [DEBUG] Error leyendo estado: Locator.wait_for: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("[col-id='estado']")

[10:13:42]   [DEBUG] Intentando selector alternativo para estado...
[10:13:47]   [DEBUG] Error con selector alternativo: Locator.text_content: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("div.ag-cell[col-id='estado']")

[10:13:47] Primera fila - Filtros: '', Estado: ''
[10:13:47] ⚠ El archivo más reciente no coincide con nuestra consulta o no está finalizado. Esperando...
[10:13:47]   [DEBUG] Esperado tax_number: '767', Estado esperado: 'Finalizado'
[10:13:57] Intento 2/60: Buscando archivo...
[10:14:02] ⚠ Botón refresh no encontrado
[10:14:02]   [DEBUG] Buscando filas en tabla con selector '.ag-row[role='row']'
[10:14:02]   [DEBUG] Encontradas 30 filas en la tabla
[10:14:02]   [DEBUG] Analizando primera fila...
[10:14:02]   [DEBUG] Buscando celda 'filtros' con selector [col-id='filtros']
[10:14:07]   [DEBUG] Error leyendo filtros: Locator.wait_for: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("[col-id='filtros']")

[10:14:07]   [DEBUG] Intentando selector alternativo para filtros...
[10:14:12]   [DEBUG] Error con selector alternativo: Locator.text_content: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("div.ag-cell[col-id='filtros']")

[10:14:12]   [DEBUG] Buscando celda 'estado' con selector [col-id='estado']
[10:14:17]   [DEBUG] Error leyendo estado: Locator.wait_for: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("[col-id='estado']")

[10:14:17]   [DEBUG] Intentando selector alternativo para estado...
[10:14:22]   [DEBUG] Error con selector alternativo: Locator.text_content: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("div.ag-cell[col-id='estado']")

[10:14:22] Primera fila - Filtros: '', Estado: ''
[10:14:22] ⚠ El archivo más reciente no coincide con nuestra consulta o no está finalizado. Esperando...
[10:14:22]   [DEBUG] Esperado tax_number: '767', Estado esperado: 'Finalizado'
[10:14:32] Intento 3/60: Buscando archivo...
[10:14:37] ⚠ Botón refresh no encontrado
[10:14:37]   [DEBUG] Buscando filas en tabla con selector '.ag-row[role='row']'
[10:14:37]   [DEBUG] Encontradas 30 filas en la tabla
[10:14:37]   [DEBUG] Analizando primera fila...
[10:14:37]   [DEBUG] Buscando celda 'filtros' con selector [col-id='filtros']
[10:14:42]   [DEBUG] Error leyendo filtros: Locator.wait_for: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("[col-id='filtros']")

[10:14:42]   [DEBUG] Intentando selector alternativo para filtros...
[10:14:47]   [DEBUG] Error con selector alternativo: Locator.text_content: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("div.ag-cell[col-id='filtros']")

[10:14:47]   [DEBUG] Buscando celda 'estado' con selector [col-id='estado']
[10:14:52]   [DEBUG] Error leyendo estado: Locator.wait_for: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("[col-id='estado']")

[10:14:52]   [DEBUG] Intentando selector alternativo para estado...
[10:14:57]   [DEBUG] Error con selector alternativo: Locator.text_content: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("div.ag-cell[col-id='estado']")

[10:14:57] Primera fila - Filtros: '', Estado: ''
[10:14:57] ⚠ El archivo más reciente no coincide con nuestra consulta o no está finalizado. Esperando...
[10:14:57]   [DEBUG] Esperado tax_number: '767', Estado esperado: 'Finalizado'
[10:15:07] Intento 4/60: Buscando archivo...
[10:15:12] ⚠ Botón refresh no encontrado
[10:15:12]   [DEBUG] Buscando filas en tabla con selector '.ag-row[role='row']'
[10:15:12]   [DEBUG] Encontradas 30 filas en la tabla
[10:15:12]   [DEBUG] Analizando primera fila...
[10:15:12]   [DEBUG] Buscando celda 'filtros' con selector [col-id='filtros']
[10:15:17]   [DEBUG] Error leyendo filtros: Locator.wait_for: Timeout 5000ms exceeded.
Call log:
  - waiting for locator(".ag-row[role='row']").first.locator("[col-id='filtros']")

[10:15:17]   [DEBUG] Intentando selector alternativo para filtros...
